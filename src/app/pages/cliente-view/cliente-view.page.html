<div *ngIf="!!cliente" class="ion-page" id="main-content">

  <ion-header [translucent]="true">
    <ion-toolbar color="secondary">
      <ion-buttons slot="start">
        <ion-back-button defaultHref="clientes"></ion-back-button>
      </ion-buttons>
      <ion-buttons slot="end">
        <ion-menu-button color="light"></ion-menu-button>
      </ion-buttons>
      <ion-title> Cliente </ion-title>
      <!-- 
      <ion-title *ngIf="viewMode && cliente!!">{{ cliente.nombre }}</ion-title>
      <ion-title *ngIf="editMode">Editar Cliente</ion-title>
      <ion-title *ngIf="createMode">Crear Cliente</ion-title> -->
    </ion-toolbar>
  </ion-header>

  <ion-content>

    <!-- <ion-item id="formCliente" *ngIf="createMode"> -->

    <form [formGroup]="clienteForm" (ngSubmit)="onSubmit(clienteForm,$event)">
      <div>

        <ion-item>
          <ion-input formControlName="nombreCliente" maxlength="100" type="text" name="nombre" placeholder="Nombre">
          </ion-input>
        </ion-item>
        <div *ngFor="let error of errorMessages.nombre">
          <ng-container *ngIf="nombre.hasError(error.type) && (nombre.dirty || nombre.touched)">
            <small class="error-message">{{ error.message }}</small>
          </ng-container>
        </div>
        <ion-item>
          <ion-input formControlName="cuit" maxlength="11" type="string" name="cuit" placeholder="CUIT"></ion-input>
          <ion-input formControlName="promedio_espera" placeholder="% Minutos de espera" name="promedio_espera">
          </ion-input>
        </ion-item>
        <ion-item>
          <ion-input formControlName="observaciones" type="text" name="observaciones" placeholder="Observaciones">
          </ion-input>
        </ion-item>

        <ion-item>
          <ion-input formControlName="calle" size="auto" class="search-input" type="text" name="calle"
            placeholder="Calle">
          </ion-input>
          <ion-input formControlName="altura" type="text" name="altura" placeholder="Altura"></ion-input>
        </ion-item>
        <ion-item>
          <ion-input formControlName="localidad" type="text" name="localidad" placeholder="Localidad"></ion-input>
        </ion-item>
        <ion-item>
          <ion-input formControlName="provincia" type="text" name="provincia" placeholder="Provincia"></ion-input>
        </ion-item>
        <!--  <ion-item>
          <agm-map [zoom]="15" [latitude]="lat" [longitude]="lng">
            <agm-marker [latitude]="lat" [longitude]="lng"></agm-marker>
          </agm-map>
        </ion-item> -->

        <div formArrayName="contactos">
          <ion-item lines="none">
            <ion-label>Contactos</ion-label>
            <ion-button *ngIf="!viewMode" type="button" (click)="addContactoFormRow($event)" slot="end" fill="clear">
              <ion-icon name="add-circle"></ion-icon>
            </ion-button>
          </ion-item>
          <div *ngFor="let contacto of clienteForm.get('contactos')['controls']; let i = index">
            <div [formGroupName]="i">
              <ion-item-group>
                <ion-item lines="none" style="vertical-align: middle;" class="ion-text-center">
                  <ion-label>Contacto N°{{i+1}}</ion-label>
                  <ion-button *ngIf="!viewMode" fill="clear" color="danger" slot="end"
                    (click)="removeContactoFormRow(i)">
                    <ion-icon name="trash-outline"></ion-icon>
                  </ion-button>
                </ion-item>
                <ion-input placeholder="Nombre" type="text" required formControlName="nombre"></ion-input>
                <ion-input placeholder="Apellido" type="text" required formControlName="apellido"></ion-input>
                <ion-input placeholder="Teléfono" type="text" required formControlName="telefono"></ion-input>
                <ion-input placeholder="Email" type="email" required formControlName="email">
                </ion-input>
              </ion-item-group>
            </div>
          </div>
          <div *ngFor="let error of errorMessages.contacto">
            <ng-container *ngIf="contacto.hasError(error.type) && (contacto.dirty || contacto.touched)">
              <small class="error-message">{{ error.message }}</small>
            </ng-container>
          </div>
        </div>

        <ion-list formArrayName="disponibilidades">
          <ion-item *ngFor="let disponibilidad of clienteForm.get('disponibilidades')['controls']; let i = index"
            style="width: 100%;" lines="none">
            <!-- <ion-grid [formGroupName]="i">
               <ion-input formControlName="disponibilidadDiaSemana" readonly></ion-input> 
              <ion-row class="ion-align-items-center">

                <ion-col size="1">
                  <ion-checkbox formControlName="disponibilidadSeleccionado"></ion-checkbox>
                </ion-col>

                <ion-col size="5">
                  <ion-input formControlName="disponibilidadDiaSemana" readonly></ion-input>
                </ion-col>

                <ion-col size="3">
                  <ion-datetime placeholder="Apert." formControlName="disponibilidadHoraApertura" displayFormat="HH:mm">
                  </ion-datetime>
                </ion-col>

                <ion-col size="3">
                  <ion-datetime placeholder="Cierre" formControlName="disponibilidadHoraCierre" displayFormat="HH:mm">
                  </ion-datetime>
                </ion-col>

              </ion-row>
            </ion-grid> -->
            <div [formGroupName]="i">
              <!-- <ion-input formControlName="disponibilidadDiaSemana" readonly></ion-input> -->
              <ion-item style="width: 100%;">

                <ion-checkbox style="width: 20px;" formControlName="disponibilidadSeleccionado"></ion-checkbox>

                <ion-input style="width: 50%; margin-left: 20px;" formControlName="diaSemana" readonly></ion-input>

                <ion-datetime style="width: 25%;" placeholder="Apertura" formControlName="hora_apertura"
                  displayFormat="HH:mm">
                </ion-datetime>

                <ion-datetime style="width: 25%; margin-left: 20px;" placeholder="Cierre" formControlName="hora_cierre"
                  displayFormat="HH:mm">
                </ion-datetime>

              </ion-item>
            </div>
          </ion-item>
        </ion-list>

        <!-- <ion-item *ngFor="let contacto of cliente.contactos; let idx = index">
          <ion-label color="primary">{{cliente.contacto.nombre}}{{idx+1}}</ion-label>
          <ion-input type="text" text-right [(ngModel)]="cliente.contactos[idx].nombre"></ion-input>
          <ion-input type="text" text-right [(ngModel)]="cliente.contactos[idx].apellido"></ion-input>
        </ion-item>
        <ion-button (click)="Add()">Add More</ion-button>
        <ion-button full (click)="goTo()">let's go</ion-button>

        <ion-card *ngIf="data">
          <ion-item *ngFor="let contacto of cliente.contactos">
            <div class="card-title">{{contacto.nombre}}</div>
          </ion-item>
        </ion-card> -->


        <!-- <div *ngFor="let error of errorMessages.cliente">
          <ng-container *ngIf="cliente.hasError(error.type) && (cliente.dirty || cliente.touched)">
            <small class="error-message">{{ error.message }}</small>
          </ng-container>
        </div> -->

      </div>

      <!-- <ion-fab vertical="bottom" horizontal="end" > -->
      <ion-fab *ngIf="!viewMode && clienteForm.enabled" bottom rigth edge>
        <!-- <ion-button [disabled]="clienteForm.invalid" type="submit" color="warning"> -->
        <ion-button type="submit" color="warning">
          <ion-icon name="save-outline"></ion-icon>
        </ion-button>
      </ion-fab>
      <!-- <ion-item>
        <ion-button class="btn btn-primary" type="submit" [disabled]="clienteForm.invalid">Guardar</ion-button>
      </ion-item> -->
    </form>

    <ion-fab *ngIf='viewMode' vertical="bottom" horizontal="start" slot="fixed">
      <ion-fab-button  color="warning" (click)="editarProducto()">
        <ion-icon name="create-outline"></ion-icon>
      </ion-fab-button>
    </ion-fab>

    <ion-fab *ngIf="viewMode" vertical="bottom" horizontal="end" slot="fixed">
      <ion-fab-button color="danger" (click)="borrarCliente()">
        <ion-icon name="trash-outline"></ion-icon>
      </ion-fab-button>
    </ion-fab>


  </ion-content>


  <!--  <ion-footer>
    <ion-toolbar color="light">
      <ion-buttons color="light" slot="start">
        <a class="waves-effect waves-light btn-small">button</a>
      </ion-buttons>
    </ion-toolbar>
  </ion-footer> -->
</div>